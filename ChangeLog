2014-02-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.exec_scanner): Rename method to exec_scan.
	(OSPDaemon.finish_scan): New method.
	(OSPDaemon.start_scan): Add debug message for scan start.
	(OSPDaemon.handle_timeout): Call finish_scan method.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scanner): Rename to
	exec_scan. Adjust log messages and call finish_scan. Rename
	handle_timeout calls.
	(OSPDOvaldi.parse_oval_syschar_xml): Handle IOError when trying to
	read oval_syschar.xml file.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af.exec_scanner): Rename to
	exec_scan. Write scans output file in host temporary directory. Remove
	extraneous debug messages. Finish with finish_scan method.

2014-02-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py: Improt cElementTree.
	(OSPDOvaldi.__init__): Use cafile parameter when initializing the parent
	class.
	(OSPDOvaldi.exec_scanner): Adjust add_scan_error method call.
	(OSPDOvaldi.parse_ovaldi_log,parse_result_xml,parse_oval_syschar_xml):
	New class methods.

	* ospd/misc.py (ScanCollection.add_alert,add_log,add_error): Add name
	argument. Rename msg argument to value.

	* ospd/ospd.py: Import cElementTree when available.
	(OSPDaemon.handle_timeout): Adjust add_scan_error method call.
	(OSPDaemon.get_scan_results_xml): Call get_result_xml method.
	(OSPDaemon.get_result_xml): New method.
	(OSPDaemon.add_scan_log,add_scan_alert,add_scan_error): Add name
	argument. Rename msg argument to value.

	* wrappers/w3af/ospd-w3af.py: Remove unneeded import.
	(OSPDw3af.store_scan_results): Adjust methods calls.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (ScanCollection.set_progress): Set start_time and
	end_time adequately.
	(ScanCollection.get_start_time, ScanCollection.get_end_time): New
	functions.

	* ospd/ospd.py (OSPDaemon.get_scan_xml): Print start_time and end_time
	scan element attributes.
	(OSPDaemon.get_scan_start_time, OSPDaemon.get_scan_end_time): New
	functions.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (result_type): Delete instance.
	(ResultType.get_str): New class method.
	(ScanCollection): Use ResultType class instead of removed instance.

	* ospd/ospd.py: Import ResultType from misc.
	(OSPDaemon.new_client_stream): Add debug message.
	(OSPDaemon.get_scan_results_xml): Print result type's string value.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add authentication with client certificates.

	* ospd/misc.py: Add default values variables for various options.
	(create_args_parser): Add --ca-file option. Update documentation.
	Refactor to use default values variables.
	(get_common_args): Parse ca-file option. Use default value variables.
	Update certs files documentation to point to using openvas-mkcert to
	generate server certificates instead.

	* ospd/ospd.py (OSPDaemon.__init__): Add cafile argument.
	(OSPDaemon.new_client_stream): Force usage of client certificates to
	authenticate. Print failure error accordingly.
	(OSPDaemon.handle_command): Adjust erroneous command debug message. Do
	not handle authenticate command as authentication is now done with
	client certificates.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.__init__): Add cafile
	argument.
	(main): Style upate.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af.__init__): Add cafile argument.
	(main): Style upate.

2014-02-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospy.py (OSPDaemon.handle_client_stream): Handle reading from
	socket exception when client abruptly closes the socket.
	(OSPDaemon.close_client_stream): Handle socket.error exception when
	shutting down socket.
	(OSPDaemon.run): Adjust calls to handle_client_stream and
	close_client_stream.

2014-01-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: New.

	* ospd/misc.py (create_args_parser, get_common_args): Adjust default
	scanner timeout value.

2014-01-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py, ospd/misc.py: New.

2014-01-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* wrappers/ovaldi/doc/, wrappers/ovaldi/doc/remote-ovaldi-doc.txt,
	wrappers/ovaldi/remote-ovaldi-setup.sh,
	wrappers/ovaldi/remote-ovaldi.sh: New. Moved here from
	tools/remote-ovaldi.

2014-01-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting module "ospd".

	* COPYING, README, INSTALL, ospd/, ospd/__init__.py, wrappers/,
	wrappers/ovaldi/, wrappers/ovaldi/sampledata/,
	wrappers/ovaldi/sampledata/defs.xml, wrappers/w3af/: New.
