2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* ospd/misc.py: Don;'t make the parser return array, we want only one
	  argument anyway.

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* ospd/misc.py: create_args_parser: remove default parameter value.

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* ospd/misc.py: Make use of the python standard logger

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: Remove
	  (now) unused imports, use (previously) unused variables

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py,
	  ospd/misc.py: Move the main to the misc module.

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* wrappers/w3af/ospd-w3af.py: Better use python standard logger

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py: Use the standard logger.

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py,
	  ospd/misc.py: Use sys.exit instead of exit from the site module.

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* tests/testOSPDError.py, ospd/ospd.py: Make use of exceptions to
	  throw OSPD errors

2014-11-18  Benoît Allard  <benoit.allard@greenbone.net>

	* setup.py, tests/__init__.py: Add framework to host some unit-tests.

2014-11-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPD_W3AF_PARAMS): Add
	http_response_status scanner parameter.
	(OSPDw3af [get_scan_params]): Get the new scanner parameter.
	(OSPDw3af [exec_scan]): Adjust store_scan_results() method call. Add
	assert.
	(OSPDw3af [store_scan_results]): Add new method parameter to specify
	whether to parse results reports for http response status. Correctly get
	the httperquest element for the request status and headers.

2014-11-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPD_W3AF_PARAMS): Add http_request_status
	and http_request_headers scanner parameters.
	(OSPDw3af [get_scan_params]): Get the new scanner parameters.
	(OSPDw3af [store_scan_results]): Add new method parameters to specify
	whether to parse results reports for http request status and request
	headers.
	(OSPDw3af [exec_scan]): Adjust store_scan_results() method call. Add
	asserts.

2014-11-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [get_scan_param]): New method.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [get_scan_params]): New method.
	(OSPDw3af [handle_start_scan_command]): Use new method to get dict of
	scanner parameters.

2014-11-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [store_scan_results]): Strip off
	the vuln and info's http request internal ID as it is meaningless.

2014-11-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [new_client_stream]): Handle socket related
	exceptions when doing SSL/TLS handshake.
	(OSPDaemon [handle_client_stream]): Handle different exceptions when
	reading from ssl wrapped socket.

2014-10-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (ScanCollection [create_scan]): Initalize exec_thread's
	value in scan_info.
	(ScanCollection [get_thread, set_thread]): New class methods.

	* ospd/ospd.py (OSPDaemon [start_scan]): Use threading module. Set the
	scan's executing thread.
	(OSPDaemon [check_scan_thread, get_scan_thread]): New methods.
	(OSPDaemon [handle_get_scans_command, handle_delete_scan_command]):
	Call check_scan_thread() method adequately.

2014-10-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPdovaldi [exec_scan]): Don't provide
	timeout value for ssh exec_cmd() call, as it is already set on ssh
	connect().

2014-10-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi [exec_scan]): Use correct
	error string in case of authentication failure error, and correctly
	clean-up local directory on other errors.

2014-10-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [check]): Improve check for
	ability to launch w3af_console correctly.

2014-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Fix scanner type.

	* README: Fix hostname.

2014-10-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* setup.py: Increased version to 1.0+beta4.

2014-10-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the ospd 1.0+beta3 release.

	* CHANGES: Updated.

2014-10-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* INSTALL: Add section on generating OSP documentation.

	* ospd/doc/generate, ospd/doc/HTML.xsl, ospd/doc/OSP.xml: Move files to
	doc/ directory.

2014-09-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/doc/generate, ospd/doc/OSP.xml, ospd/doc/HTML.xsl: New
	OSP documentation files.

2014-09-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py: Check for profile name without importing
	w3af.

2014-09-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (get_commands_table): Document help command's format
	attribute.
	(OSPDaemon [handle_help_command]): Handle text format type.

2014-09-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (ScanCollection [add_alarm, add_log, add_error): Make
	result entries as dictionnaries instead of tuples. Add result severity.

	* ospd/ospd.py (get_result_xml): Add result severity. Adjust for result
	entries being dictionnaries.
	(OSPDaemon [add_scan_alarm]): Add severity method parameter.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [store_scan_results]): Extract
	vulnerabilities severity values.

2014-09-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (go_to_background): Call exit() directly.

	* ospd/ospd.py (OSPDaemon [set_command_elements]): Rename to
	init_scanner_params(). Adjust method accordingly.

	* wrappers/w3af/ospd-w3af.py (OSPDOvaldi),
	wrappers/ovaldi/ospd-ovaldi.py (OSPDw3af): Call init_scanner_params()
	method to setup scanner specific parameters.

2014-09-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (go_to_background): New function.
	(create_args_parser, get_common_args): Add --background option.

	* wrappers/w3af/ospd-w3af.py, wrappers/ovaldi/ospd-ovaldi.py: Check for
	and handle --background option.

2014-09-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [get_result_xml, simple_response_str]): Move
	methods out to be independant functions. Adjust calls accordingly.

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: Adjust
	simple_response_str() function calls.

2014-09-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (SyslogLogger): Add class doc string.

	* ospd/ospd.py (OSPDaemon [get_commands_table]): Move out method to be a
	function.
	(OSPDaemon): Initialize class variable.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi [get_definition_result]):
	Move out method to be a function.

	* wrappers/w3af/ospd-w3af.py: Add module doc string, add exceptions
	types, refactor code and fix code style for constant variables.
	(OSPDw3af): Move out get_w3af_version() method to be a function, remove
	unused variable and fix code style.
	(OSPDw3af [handle_start_scan_command]): Add exception type.

2014-09-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (ospd_w3af_params): Add use_https scanner
	parameter.
	(OSPDw3af [handle_start_scan_command, create_w3af_script]): Handle
	use_https scanner parameter and set target url accordingly.
	(OSPDw3af [exec_scan]): Add scan options asserts.

2014-09-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* setup.py: Increased version to 1.0+beta3.

2014-09-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the ospd 1.0+beta2 release.

	* CHANGES: Updated.

2014-09-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py: Output help message when not able to
	import w3af.
	(OSPDw3af [handle_start_scan_command, create_w3af_script]): Check
	profile name dynamically, instead of using a hard-coded list.

2014-09-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [get_result_xml]): Escape xml result text.

	* wrappers/w3af/ospd-w3af.py (ospd_w3af_params): Add target_port scanner
	parameter.
	(OSPDw3af [handle_start_scan_command, create_w3af_script]): Handle
	target port scanner parameter accordingly.

2014-09-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py: Replace always false assertions with NotImplementedError
	exception.

2014-09-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add --syslog option.

	* ospd/misc.py (OSPLogger [print_message]): Make method private.
	(SyslogLogger): New class.
	(create_args_parser): Add --syslog option.

	* ospd/ospd.py (OSPDaemon): Remove debug argument.
	(OSPDaemon [set_logger]): New method.

	* wrappers/ovaldi/ospd-ovaldi.py: Adjust OSPDOvaldi initialization and
	use syslog logger accordingly.
	(OSPDOvaldi):  Remove debug argument.

	* wrappers/w3af/ospd-w3af.py: Adjust OSPDw3af initialization and
	use syslog logger accordingly.
	(OSPDw3af):  Remove debug argument.

2014-09-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [get_scanner_description]): Add assert
	failure when not implemented by subclass.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi),
	wrappers/w3af/ospd-w3af.py (OSPw3af): Implement get_scanner_description
	method. Remove useless class variables.

2014-09-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [store_scan_results]): Add
	vulnerabilities and information entries names to the scan report.

2014-09-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/w3af/ospd-w3af.py (OSPDw3af [exec_scan]): Don't remove output
	file in debugging mode.

2014-09-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon [__init__]): Remove port and address as
	initialization parameters. Regroup class members adequately.
	(OSPDaemon [handle_start_scan_command, exec_scan]): Assert method
	parameters.
	(OSPDaemon [get_daemon_name, get_daemon_version])
	([get_scanner_description]): Adjust for class members changes.
	(OSPDaemon [bind_socket, start_daemon, run]): Add address and port
	arguments.
	(OSPDaemon [new_client_stream]): Add sock argument.

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py (OSPw3af):
	Adjust for OSPDaemon class changes.

2014-09-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.get_scanner_param_default): New method.
	(OSPDaemon.get_scanner_params_xml): Add param value to the params xml.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPD_OVALDI_PARAMS): Add parameters
	default values.
	(OSPDOvaldi): Use params default values instead of hardcoded ones.

	* wrappers/w3af/ospd-w3af.py (ospd_w3af_params): Add default values.
	(OSPDw3af):  Use params default values instead of hardcoded ones.

2014-09-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (create_args_parser, get_common_args): Remove timeout cli
	argument.

	* ospd/ospd.py (OSPDaemon): Remove timeout argument.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPD_OVALDI_PARAMS): Add ssh_timeout
	scanner parameter.
	(OSPOvaldi): Remove timeout argument. Use ssh_timeout scanner parameter
	instead.

	* wrappers/w3af/ospd-w3af.py (ospd_w3af_params): Add w3af_timeout
	scanner parameter.
	(OSPDw3af): Remote timeout argument. Use w3af_timeout scanner parameter
	instead.

2014-09-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Fix typo.

2014-09-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPD_OVALDI_PARAMS): Change port type
	to integer. Change definitions_file type to file. Improve description.

2014-09-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* setup.py, ospd/misc.py, ospd/ospd.py,
	wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: Ensure the
	GPLv2+ license notice uses the paragraph suggested by the Free
	Software Foundation.

2014-08-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* setup.py: Increased version to 1.0+beta2.

2014-08-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the ospd 1.0+beta1 release.

	* ospd/ospd.py (OSP_VERSION): Increased protocol version to 0.1.0.

	* setup.py: Increased version to 1.0+beta1. Drop Python 2.6 as a
	supported version.

	* INSTALL: Added python minimum version 2.7.

	* CHANGES: New.

	* README: Cleaned and updated.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.__init__): Increased
	version numnber to 1.0+beta1.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af.__init__): Increased
	version numnber to 1.0+beta1.

2014-08-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py: Add module docstring, fix code
	style and remove unused variables. Remove outdated todo.

	* ospd/ospd.py (OSPDaemon.handle_start_scan_command)
	(OSPDaemon.exec_scan): Fix function arguments of unimplemented base
	methods.

2014-08-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py: Add module docstring.
	(OSPDaemon): Initialize socket variable in constructor.  Fix code
	indentation and style. Remove unused variables and remove unused
	function arguments.
	(OSPDaemon.handle_get_scanner_details_command): Add method docstring.

2014-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py: Add module docstring and fix various warnings and errors
	reported by pylint.

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: Adjust
	get_common_args() calls.

2014-08-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (ResultType): Adjust result types to match the used ones
	by OpenVAS Manager.

2014-08-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.get_scanner_params_xml): Adjust to get
	parameter identifier from the key value.
	(OSPDaemon.get_help_text()): Improve formatting. Call elements_as_text
	to handle composed values.
	(OSPDaemon.elements_as_text): New method.

	* wrappers/ovaldi/ospd-ovaldi.py (ospd_ovaldi_params): Use parameters
	id's as dictionnary's keys.
	(OSPDOvaldi.__init__): Use scanner_params values when setting start_scan
	command's elements.

	* wrappers/w3af/ospd-w3af.py (ospd_w3af_description, ospd_w3af_params):
	New variable.
	(OSPDw3af.__init__): Set scanner description and parameters adequately.

2014-08-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.handle_get_scans_command): Adjust code to
	correctly close get_scans_response tag.

2014-08-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospdy.py (OSPDaemon.__init__): Set description and scanner_params
	default values.
	(OSPDaemon.get_commands_table): Add get_scanner_details command.
	(OSPDaemon.get_scanner_description, OSPDaemon.get_scanner_params_xml)
	(OSPDaemon.handle_get_scanner_details_command): New methods.
	(OSPDaemon.handle_command): Handle get_scanner_details command.

	* wrappers/ovaldi/ospd-ovaldi.py (ospd_ovaldi_description)
	(ospd_ovaldi_params): New variables.
	(OSPDOvaldi.__init__): Set daemon description and scanner parameters.

2014-08-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.handle_get_scans_command)
	(OSPDaemon.handle_help_command, OSPDaemon.handle_delete_scan_command)
	(OSPDaemon.handle_command, OSPDaemon.handle_get_version): Use
	simple_response_str method for consistency. Fix and improve various
	responses.
	(OSPDaemon.create_response_string): Rename method to get_xml_str().
	(OSPDaemon.get_scan_xml, OSPDaemon.handle_get_version): Call
	get_xml_str() method adequately.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scan),
	wrappers/w3af/ospd-w3af.py (OSPDw3af.exec_scan): Use new method.

2014-08-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.start_daemon): Return True or False for
	consistency.
	(OSPDaemon.simple_response_str): New method.
	(OSPDaemon.run): Adjust start_daemon() call and return value.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.handle_start_scan_command):
	Fetch the scan parameters from scanner_params element. Use new method
	for consistent response strings. Decode base64 definitions file to catch
	errors earlier.
	(OSPDOvaldi.exec_scan): Don't decode definitions content as it is
	already done.

	* wrappers/w3af/ospd-w3af.py (OSPDOvaldi.handle_start_scan_command):
	Fetch scan profile from scanner_params element. Use new method for
	response string consistency.

2014-08-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.parse_oval_results): Only
	add definitions evaluated as true as scan results. Don't add false,
	error, unknown and not applicable definitions as they are only in the
	ovaldi.log.

2014-08-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scan): Use specified
	time-out value when connecting to the target.

2014-08-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.parse_results_xml)
	(OSPDOvaldi.parse_oval_syschar_xml): Handle results and syschar reports
	generated by some ovaldi versions where generator child element's tag
	isn't in the oval namespace.

2014-08-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.check_ovaldi): New method.
	(OSPDOvaldi.exec_scan): Call new method to check for ovaldi binary on
	target and the oval schema folder presence. Adjust command to
	explicitly specify the schema folder.

2014-08-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (OSPLogger.get_level): New method.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scan): Use sftp
	connection to create temporary directory and report error accordingly.
	Add debug message for ovaldi command run on target. Do not remove
	directory on target host when debugging is set.

2014-08-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scan): Handle case
	when sftp to the target is not possible and report the error correctly.

2014-07-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* setup.py: Added paramiko to install_requires.

	* INSTALL: Added hint on automatic download/install when using setup.py.

2014-07-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Remove unused remote-ovaldi.sh and related files.

	* INSTALL: Add python-paramiko dependency.

	* README: Adjust documentation for remote-ovaldi.sh removal.

	* setup.py: Don't install removed files.

	* wrappers/ovaldi/doc/remote-ovaldi-doc.txt,
	wrappers/ovaldi/remote-ovaldi-setup.sh,
	wrappers/ovaldi/remote-ovaldi.sh: Remove files.

	* wrappers/ovaldi/ospd-ovaldi.py: Remove --remote-ovaldi cli argument
	handling.
	(OSPDOvaldi.__init__): Remove rovaldi_path parameter.
	(OSPDOvaldi.get_scanner_name, OSPDOvaldi.get_scanner_version): Adjust
	for scan method change.
	(OSPDOvaldi.exec_scan): Use command -v which is more POSIX-compliant
	instead of type.

2014-07-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Replace remote-ovaldi.sh wrapping with code in ospd-ovaldi.py to check
	for and run ovaldi over SSH directly.

	* wrappers/ovaldi/ospd-ovaldi.py: Import paramiko. Don't import
	psexpect.
	(OSPDOvaldi.check): Remove check for remote-ovaldi.sh.
	(OSPDOvaldi.finish_scan_with_err): New class method.
	(OSPDOvaldi.exec_scan): Connect to the target with SSH instead of
	executing remote-ovaldi.sh and parsing the output. Check for ovaldi's
	presence on the target, create the temporary directory, copy the
	definitions files, run the scan, get the results files and cleanup.
	Improve handling of various errors.
	(OSPDOvaldi.parse_oval_syschar_xml, OSPDOvaldi.parse_results_xml)
	(OSPDOvaldi.parse_ovaldi_log): Take file path as method argument.

2014-07-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon): Rename delete_scan id attribute to scan_id
	for consistency.

2014-07-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* INSTALL, README: Update documentation.

2014-07-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Added sections about certificate creation and about
	registering a OSP daemon at OpenVAS Manager.

	* README: Removed text abuot certificates (now in INSTALL) and
	apply some slight structural improvements.

2014-07-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	First approach for a config/install methodology.

	* setup.py: New. Not optimal yet, needs further attention to
	fully suffice LFH, the python way and other deployment aspects.

	* INSTALL: Added sections on how to install ospd and ho to create
	a source package.

	* README: The daemons can now be called directly if installed
	into a path-aware directory.

2014-07-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospdy.py (OSPDaemon.handle_client_stream): Fix error when client
	closes the socket before sending any data.

2014-06-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* README: Update documentation. oval definitions are now part of the
	scan config and certs are used for authentication. Update commands
	output and command-line examples.

2014-05-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi): Handle ssh permissions
	denied case and report as scan error to client.

2014-05-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi): Change definitions option
	to definitions_file.

2014-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py, wrappers/ovaldi/ospd-ovaldi.py,
	wrappers/w3af/ospd-w3af.py, ospd/ospd.py: Replace Alert with Alarm for
	all class methods, variables, strings and comments to match the change
	in Manager.

2014-05-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospdy.py (OSPDaemon.get_commands_table): Document scan_id and
	details attributes for get_scan command.
	(OSPDaemon.handle_get_scans_command): Handle details attribute.
	(OSPDaemon.get_scan_xml): Add detailed function argument, don't send
	results when set to False.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.parse_oval_syschar_xml)
	(OSPDOvaldi.parse_results_xml, OSPDOvaldi.parse_ovaldi_log): Only parse
	file content when no exception was raised.

2014-05-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.handle_get_scans_command): Support scan_id
	attribute usage for get_scans command to get one specific scan report.
	(OSPDaemon.get_scan_xml): Don't send back options content as client
	already has those and they may contain sensitive information like
	passwords or have huge size like ovaldi definitions file.

2014-04-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.handle_client_stream): Read all the client
	input before trying to handle it, in order to better handle commands
	with large content.

	* ovaldi/ospd-ovaldi.py (OSPDOvaldi.__init__): Remove defsfile argument.
	Add definitions element to start_scan command.
	(OSPDOvaldi.handle_start_scan_command, OSPDOvaldi.exec_scan): Use
	definitions file from client input instead of local file from path in
	options.
	(__main__): Remove --defs-file cli option.

	* w3af/ospd-w3af.py (OSPDw3af.create_w3af_script): Delete duplicate file
	close.

2014-02-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scan): Correct comment
	and fix function call.
	(OSPDOvaldi.parse_result_xml): Rename to parse_results_xml. Fix path to
	results file. Parse results element and call parse_oval_results instead
	of parse_oval_definitions.
	(OSPDOvaldi.parse_oval_definitions): Rename to parse_oval_results. Add
	results argument. Add definitions results as scan results values instead
	of definition titles.
	(OSPDOvaldi.get_definition_result): New function.

	* wrappers/ovaldi/remote-ovaldi.sh: Fix results file name to better
	match default value.

2014-02-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/oaldi/ospd-ovaldi.py (OSPOvaldi.exec_scan): Add debug
	messages for various steps of the scan.

2014-02-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py (OSPOvaldi.parse_oval_syschar_xml):
	Parse system characteristics generator information.
	(OSPDOvaldi.parse_result_xml): Extract individual results from the file
	content and adequately add their values as scan results.
	(OSPDOvaldi.parse_oval_definitions): New function.

2014-02-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py (OSPDaemon.exec_scanner): Rename method to exec_scan.
	(OSPDaemon.finish_scan): New method.
	(OSPDaemon.start_scan): Add debug message for scan start.
	(OSPDaemon.handle_timeout): Call finish_scan method.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.exec_scanner): Rename to
	exec_scan. Adjust log messages and call finish_scan. Rename
	handle_timeout calls.
	(OSPDOvaldi.parse_oval_syschar_xml): Handle IOError when trying to
	read oval_syschar.xml file.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af.exec_scanner): Rename to
	exec_scan. Write scans output file in host temporary directory. Remove
	extraneous debug messages. Finish with finish_scan method.

2014-02-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py: Improt cElementTree.
	(OSPDOvaldi.__init__): Use cafile parameter when initializing the parent
	class.
	(OSPDOvaldi.exec_scanner): Adjust add_scan_error method call.
	(OSPDOvaldi.parse_ovaldi_log,parse_result_xml,parse_oval_syschar_xml):
	New class methods.

	* ospd/misc.py (ScanCollection.add_alert,add_log,add_error): Add name
	argument. Rename msg argument to value.

	* ospd/ospd.py: Import cElementTree when available.
	(OSPDaemon.handle_timeout): Adjust add_scan_error method call.
	(OSPDaemon.get_scan_results_xml): Call get_result_xml method.
	(OSPDaemon.get_result_xml): New method.
	(OSPDaemon.add_scan_log,add_scan_alert,add_scan_error): Add name
	argument. Rename msg argument to value.

	* wrappers/w3af/ospd-w3af.py: Remove unneeded import.
	(OSPDw3af.store_scan_results): Adjust methods calls.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (ScanCollection.set_progress): Set start_time and
	end_time adequately.
	(ScanCollection.get_start_time, ScanCollection.get_end_time): New
	functions.

	* ospd/ospd.py (OSPDaemon.get_scan_xml): Print start_time and end_time
	scan element attributes.
	(OSPDaemon.get_scan_start_time, OSPDaemon.get_scan_end_time): New
	functions.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/misc.py (result_type): Delete instance.
	(ResultType.get_str): New class method.
	(ScanCollection): Use ResultType class instead of removed instance.

	* ospd/ospd.py: Import ResultType from misc.
	(OSPDaemon.new_client_stream): Add debug message.
	(OSPDaemon.get_scan_results_xml): Print result type's string value.

2014-02-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add authentication with client certificates.

	* ospd/misc.py: Add default values variables for various options.
	(create_args_parser): Add --ca-file option. Update documentation.
	Refactor to use default values variables.
	(get_common_args): Parse ca-file option. Use default value variables.
	Update certs files documentation to point to using openvas-mkcert to
	generate server certificates instead.

	* ospd/ospd.py (OSPDaemon.__init__): Add cafile argument.
	(OSPDaemon.new_client_stream): Force usage of client certificates to
	authenticate. Print failure error accordingly.
	(OSPDaemon.handle_command): Adjust erroneous command debug message. Do
	not handle authenticate command as authentication is now done with
	client certificates.

	* wrappers/ovaldi/ospd-ovaldi.py (OSPDOvaldi.__init__): Add cafile
	argument.
	(main): Style upate.

	* wrappers/w3af/ospd-w3af.py (OSPDw3af.__init__): Add cafile argument.
	(main): Style upate.

2014-02-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospy.py (OSPDaemon.handle_client_stream): Handle reading from
	socket exception when client abruptly closes the socket.
	(OSPDaemon.close_client_stream): Handle socket.error exception when
	shutting down socket.
	(OSPDaemon.run): Adjust calls to handle_client_stream and
	close_client_stream.

2014-01-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* wrappers/ovaldi/ospd-ovaldi.py, wrappers/w3af/ospd-w3af.py: New.

	* ospd/misc.py (create_args_parser, get_common_args): Adjust default
	scanner timeout value.

2014-01-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ospd/ospd.py, ospd/misc.py: New.

2014-01-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* wrappers/ovaldi/doc/, wrappers/ovaldi/doc/remote-ovaldi-doc.txt,
	wrappers/ovaldi/remote-ovaldi-setup.sh,
	wrappers/ovaldi/remote-ovaldi.sh: New. Moved here from
	tools/remote-ovaldi.

2014-01-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting module "ospd".

	* COPYING, README, INSTALL, ospd/, ospd/__init__.py, wrappers/,
	wrappers/ovaldi/, wrappers/ovaldi/sampledata/,
	wrappers/ovaldi/sampledata/defs.xml, wrappers/w3af/: New.
